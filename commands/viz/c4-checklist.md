# C4 Diagram Review Checklist

Verify that all C4 diagrams in `codemap/` adhere to the official C4 model review checklist from https://c4model.com/diagrams/checklist.

## Prerequisites

C4 architecture map must exist in `codemap/<system-id>/` (generated by `/viz/c4-map`).

## Orchestration Strategy

This command uses **parallel verification with synthesis** - three independent checklist categories are verified in parallel, then synthesized into a unified report:

```
                    ┌─────────────────────────────┐
                    │   Phase 0: Discover System  │
                    │   & List All Diagrams       │
                    └─────────────┬───────────────┘
                                  │
        ┌─────────────────────────┼─────────────────────────┐
        │                         │                         │
        ▼                         ▼                         ▼
┌───────────────┐       ┌───────────────┐       ┌───────────────┐
│    General    │       │   Elements    │       │ Relationships │
│   Checklist   │       │   Checklist   │       │   Checklist   │
└───────┬───────┘       └───────┬───────┘       └───────┬───────┘
        │                         │                         │
        └─────────────────────────┼─────────────────────────┘
                                  │
                                  ▼
                    ┌───────────────────────────────────────┐
                    │   Phase 2: Synthesis & Scoring        │
                    │   - Aggregate findings per diagram    │
                    │   - Calculate compliance scores       │
                    │   - Generate fix recommendations      │
                    └─────────────────────────┬─────────────┘
                                              │
                                              ▼
                    ┌───────────────────────────────────────┐
                    │   Phase 3: Write Checklist Report     │
                    └───────────────────────────────────────┘
```

---

## C4 Review Checklist Reference

Based on https://c4model.com/diagrams/checklist:

### General
1. Does the diagram have a title?
2. Do you understand what the diagram type is?
3. Do you understand what the diagram scope is?
4. Does the diagram have a key/legend?

### Elements
1. Does every element have a name?
2. Do you understand the abstraction level of each element?
3. Do you understand what every element does?
4. Are technology choices associated with elements clear?
5. Do you understand the meaning of all acronyms and abbreviations?
6. Do you understand the meaning of all colours used?
7. Do you understand the meaning of all shapes used?
8. Do you understand the meaning of all icons used?
9. Do you understand the meaning of all border styles used?
10. Is the significance of element sizing apparent?

### Relationships
1. Does every line have a label describing the intent?
2. Does the description match the relationship direction?
3. Are communication technologies and protocols identified?
4. Do you understand the meaning of all acronyms and abbreviations?
5. Do you understand the meaning of all colours used?
6. Do you understand the meaning of all arrow heads used?
7. Do you understand the meaning of all line styles used?

---

## PHASE 0: Preparation

Discover the system and list all diagrams to verify.

```bash
# Find the system folder
SYSTEM_ID=$(ls codemap/ | grep -v "README.md" | grep -v ".json" | grep -v ".md" | head -1)
echo "System ID: $SYSTEM_ID"

# List all PlantUML diagram files
find codemap/$SYSTEM_ID -name "*.puml" | sort

# Count diagrams by level
echo "Context diagrams: $(find codemap/$SYSTEM_ID -name 'context.puml' | wc -l)"
echo "Container diagrams: $(find codemap/$SYSTEM_ID -name 'container.puml' | wc -l)"
echo "Component diagrams: $(find codemap/$SYSTEM_ID -name 'component.puml' | wc -l)"
echo "Code diagrams: $(find codemap/$SYSTEM_ID -name 'classes.puml' | wc -l)"
```

Read all diagram files to provide to verification subagents.

---

## PHASE 1: Parallel Checklist Verification

Launch THREE verification subagents IN PARALLEL.

### Subagent 1: General Checklist

```
Tool: Task
Parameters:
  subagent_type: "Explore"
  description: "Verify general checklist"
  prompt: |
    TASK: Verify the GENERAL section of the C4 diagram review checklist.

    SYSTEM_ID: <from Phase 0>

    DIAGRAMS TO VERIFY:
    <list all .puml files from Phase 0>

    CHECKLIST ITEMS TO VERIFY:

    For EACH diagram file, check:

    1. TITLE CHECK:
       - Does the diagram have a title?
       - In C4-PlantUML: Look for `title "..."` or `LAYOUT_WITH_LEGEND()` with title
       - Title should describe what the diagram shows
       - PASS: Has descriptive title
       - FAIL: No title or generic title like "Diagram"

    2. DIAGRAM TYPE CLARITY:
       - Is the diagram type clear (Context, Container, Component, Code)?
       - In C4-PlantUML: Check the !include statement matches expected level
         - C4_Context.puml -> Context diagram
         - C4_Container.puml -> Container diagram
         - C4_Component.puml -> Component diagram
         - No C4 include (class diagram) -> Code diagram
       - PASS: Type is unambiguous from include and content
       - FAIL: Mixed elements or wrong include for content

    3. SCOPE CLARITY:
       - Is the diagram scope clear?
       - What system/container/component is this diagram about?
       - Should be evident from title, filename path, or diagram content
       - PASS: Scope is immediately clear
       - FAIL: Unclear what this diagram covers

    4. KEY/LEGEND:
       - Does the diagram have a key or legend?
       - In C4-PlantUML: Look for `LAYOUT_WITH_LEGEND()` or `SHOW_LEGEND()`
       - Legend should explain colours, shapes, or custom notation
       - PASS: Has legend OR uses only standard C4 notation (self-explanatory)
       - WARN: Custom notation without legend
       - FAIL: Non-standard elements without explanation

    SEARCH STRATEGY:
    - Read each .puml file completely
    - Parse for title statements
    - Check !include statements
    - Look for LAYOUT_WITH_LEGEND() or SHOW_LEGEND()
    - Identify any custom notation

    OUTPUT FORMAT:
    ```json
    {
      "category": "general",
      "diagrams_checked": <count>,
      "results": [
        {
          "file": "codemap/.../context.puml",
          "diagram_level": "context|container|component|code",
          "checks": {
            "title": {
              "status": "pass|warn|fail",
              "found": "The title text if found",
              "issue": "Description if not pass"
            },
            "type_clarity": {
              "status": "pass|warn|fail",
              "detected_type": "context|container|component|code",
              "issue": "Description if not pass"
            },
            "scope_clarity": {
              "status": "pass|warn|fail",
              "detected_scope": "What scope was detected",
              "issue": "Description if not pass"
            },
            "key_legend": {
              "status": "pass|warn|fail",
              "has_legend": true|false,
              "custom_notation_found": ["list of custom elements"],
              "issue": "Description if not pass"
            }
          },
          "score": "X/4 passed"
        }
      ],
      "summary": {
        "total_checks": <count>,
        "passed": <count>,
        "warnings": <count>,
        "failed": <count>
      }
    }
    ```
```

### Subagent 2: Elements Checklist

```
Tool: Task
Parameters:
  subagent_type: "Explore"
  description: "Verify elements checklist"
  prompt: |
    TASK: Verify the ELEMENTS section of the C4 diagram review checklist.

    SYSTEM_ID: <from Phase 0>

    DIAGRAMS TO VERIFY:
    <list all .puml files from Phase 0>

    CHECKLIST ITEMS TO VERIFY:

    For EACH diagram file, check:

    1. ELEMENT NAMES:
       - Does every element have a name?
       - In C4-PlantUML: First parameter is usually the alias, second is name
         - Person(alias, "Name", "Description")
         - System(alias, "Name", "Description")
         - Container(alias, "Name", "Technology", "Description")
         - Component(alias, "Name", "Technology", "Description")
       - PASS: All elements have meaningful names
       - FAIL: Elements with empty names, generic names like "System1"

    2. ABSTRACTION LEVEL CLARITY:
       - Is each element's abstraction level clear?
       - Context: Should use Person(), System(), System_Ext()
       - Container: Should use Container(), ContainerDb(), ContainerQueue()
       - Component: Should use Component()
       - Code: Should use class, interface, abstract
       - PASS: Correct macros used for diagram level
       - FAIL: Wrong macros (e.g., Container() in context diagram)

    3. ELEMENT PURPOSE:
       - Do you understand what every element does?
       - Check description parameter in C4 macros
       - PASS: All elements have meaningful descriptions
       - WARN: Some elements lack descriptions
       - FAIL: Most elements lack descriptions

    4. TECHNOLOGY CHOICES:
       - Are technology choices clear where relevant?
       - Container/Component diagrams should specify technologies
       - PASS: Technologies specified where appropriate
       - WARN: Technologies missing for some containers/components
       - N/A: Context diagrams (technology not expected)

    5. ACRONYMS AND ABBREVIATIONS:
       - Are all acronyms/abbreviations understandable?
       - Common: API, DB, UI, HTTP, REST, SQL - OK without explanation
       - Project-specific acronyms should be expanded or explained
       - PASS: All acronyms are standard or explained
       - WARN: Some non-standard acronyms without explanation

    6. COLOUR MEANING:
       - In C4-PlantUML, standard colours have meaning:
         - Blue: Internal systems/containers/components
         - Gray: External systems
         - Custom colours should be in legend
       - PASS: Standard colours or custom colours explained
       - WARN: Custom colours without legend

    7. SHAPE MEANING:
       - C4 shapes have standard meaning (person, database, queue icons)
       - Custom shapes should be explained
       - PASS: Standard shapes or custom shapes explained

    8. ICON MEANING:
       - Sprite icons should be clear or explained
       - PASS: Icons are self-explanatory or explained

    9. BORDER STYLE MEANING:
       - Dashed borders often mean "optional" or "future"
       - Should be explained if used
       - PASS: No custom borders or borders explained

    10. ELEMENT SIZING:
        - Are larger/smaller boxes meaningful?
        - PASS: Consistent sizing or sizing explained
        - WARN: Inconsistent sizing without explanation

    SEARCH STRATEGY:
    - Read each .puml file
    - Parse all element declarations
    - Extract names, descriptions, technologies
    - Identify any custom styling
    - Check for explanatory comments

    OUTPUT FORMAT:
    ```json
    {
      "category": "elements",
      "diagrams_checked": <count>,
      "results": [
        {
          "file": "codemap/.../container.puml",
          "diagram_level": "container",
          "elements_found": [
            {
              "type": "Container|Person|System|Component|class",
              "alias": "api",
              "name": "API Server",
              "description": "Handles HTTP requests",
              "technology": "FastAPI"
            }
          ],
          "checks": {
            "element_names": {
              "status": "pass|warn|fail",
              "elements_without_names": [],
              "issue": "Description if not pass"
            },
            "abstraction_level": {
              "status": "pass|warn|fail",
              "wrong_level_elements": [],
              "issue": "Description if not pass"
            },
            "element_purpose": {
              "status": "pass|warn|fail",
              "elements_without_description": [],
              "issue": "Description if not pass"
            },
            "technology_choices": {
              "status": "pass|warn|fail|n/a",
              "elements_without_technology": [],
              "issue": "Description if not pass"
            },
            "acronyms": {
              "status": "pass|warn|fail",
              "unexplained_acronyms": [],
              "issue": "Description if not pass"
            },
            "colours": {
              "status": "pass|warn|fail",
              "custom_colours": [],
              "issue": "Description if not pass"
            },
            "shapes": {
              "status": "pass|warn|fail",
              "custom_shapes": [],
              "issue": "Description if not pass"
            },
            "icons": {
              "status": "pass|warn|fail",
              "unexplained_icons": [],
              "issue": "Description if not pass"
            },
            "borders": {
              "status": "pass|warn|fail",
              "custom_borders": [],
              "issue": "Description if not pass"
            },
            "sizing": {
              "status": "pass|warn|fail",
              "issue": "Description if not pass"
            }
          },
          "score": "X/10 passed"
        }
      ],
      "summary": {
        "total_checks": <count>,
        "passed": <count>,
        "warnings": <count>,
        "failed": <count>
      }
    }
    ```
```

### Subagent 3: Relationships Checklist

```
Tool: Task
Parameters:
  subagent_type: "Explore"
  description: "Verify relationships checklist"
  prompt: |
    TASK: Verify the RELATIONSHIPS section of the C4 diagram review checklist.

    SYSTEM_ID: <from Phase 0>

    DIAGRAMS TO VERIFY:
    <list all .puml files from Phase 0>

    CHECKLIST ITEMS TO VERIFY:

    For EACH diagram file, check:

    1. RELATIONSHIP LABELS:
       - Does every line have a label describing the intent?
       - In C4-PlantUML: Rel(from, to, "label", "technology")
       - Label should describe WHAT is being communicated or WHY
       - Good: "Sends orders", "Reads customer data", "Authenticates users"
       - Bad: Empty label, "Uses", "Calls" (too generic)
       - PASS: All relationships have meaningful labels
       - WARN: Some relationships have generic labels
       - FAIL: Relationships without labels

    2. DIRECTION MATCH:
       - Does the label match the arrow direction?
       - "Sends data to" should point TO the receiver
       - "Reads from" should point FROM the source
       - In C4-PlantUML: Rel(A, B, "label") means A -> B
       - PASS: Labels match direction
       - FAIL: Labels contradict direction

    3. TECHNOLOGY/PROTOCOL:
       - Are communication technologies identified?
       - In C4-PlantUML: Fourth parameter or in label
       - Examples: "HTTP/REST", "SQL", "gRPC", "AMQP", "WebSocket"
       - PASS: Technologies specified for inter-container/external relationships
       - WARN: Technologies missing for some relationships
       - N/A: Internal component relationships (may not need protocol)

    4. RELATIONSHIP ACRONYMS:
       - Are protocol acronyms clear?
       - Standard: HTTP, HTTPS, SQL, REST, gRPC, AMQP, TCP - OK
       - Project-specific protocols should be explained
       - PASS: All acronyms are standard or explained

    5. RELATIONSHIP COLOURS:
       - Are relationship colours meaningful?
       - Different colours might indicate sync vs async, secure vs insecure
       - Should be explained in legend if used
       - PASS: No custom colours or colours explained

    6. ARROW HEAD MEANING:
       - Standard: Solid arrow = synchronous call
       - Custom arrow heads should be explained
       - In PlantUML: --> vs ..> vs ->> etc.
       - PASS: Standard arrows or custom arrows explained

    7. LINE STYLE MEANING:
       - Solid line = synchronous
       - Dashed line = asynchronous (common convention)
       - Should be explained if non-standard
       - PASS: Standard styles or styles explained

    SEARCH STRATEGY:
    - Read each .puml file
    - Parse all Rel(), Rel_D(), Rel_U(), Rel_L(), Rel_R() calls
    - Also check for --> and ..> style relationships
    - Extract labels and technologies
    - Check for bidirectional relationships

    OUTPUT FORMAT:
    ```json
    {
      "category": "relationships",
      "diagrams_checked": <count>,
      "results": [
        {
          "file": "codemap/.../container.puml",
          "diagram_level": "container",
          "relationships_found": [
            {
              "from": "api",
              "to": "database",
              "label": "Reads/writes data",
              "technology": "SQL",
              "style": "solid|dashed",
              "direction": "forward|back|bidirectional"
            }
          ],
          "checks": {
            "labels": {
              "status": "pass|warn|fail",
              "relationships_without_labels": [],
              "generic_labels": [],
              "issue": "Description if not pass"
            },
            "direction_match": {
              "status": "pass|warn|fail",
              "mismatched_directions": [],
              "issue": "Description if not pass"
            },
            "technology_protocol": {
              "status": "pass|warn|fail|n/a",
              "relationships_without_technology": [],
              "issue": "Description if not pass"
            },
            "acronyms": {
              "status": "pass|warn|fail",
              "unexplained_acronyms": [],
              "issue": "Description if not pass"
            },
            "colours": {
              "status": "pass|warn|fail",
              "custom_colours": [],
              "issue": "Description if not pass"
            },
            "arrow_heads": {
              "status": "pass|warn|fail",
              "custom_arrows": [],
              "issue": "Description if not pass"
            },
            "line_styles": {
              "status": "pass|warn|fail",
              "custom_styles": [],
              "issue": "Description if not pass"
            }
          },
          "score": "X/7 passed"
        }
      ],
      "summary": {
        "total_checks": <count>,
        "passed": <count>,
        "warnings": <count>,
        "failed": <count>
      }
    }
    ```
```

**WAIT for ALL THREE subagents to complete before proceeding to Phase 2.**

---

## PHASE 2: Synthesis and Scoring

Aggregate all results and calculate compliance scores.

```
Tool: Task
Parameters:
  subagent_type: "general-purpose"
  description: "Synthesize checklist results"
  prompt: |
    TASK: Synthesize C4 checklist verification results into a unified report.

    VERIFICATION OUTPUTS:
    - General Checklist: <insert full output from Subagent 1>
    - Elements Checklist: <insert full output from Subagent 2>
    - Relationships Checklist: <insert full output from Subagent 3>

    SYNTHESIS GOALS:

    1. AGGREGATE BY DIAGRAM:
       Combine all checks for each diagram file:
       - General checks (4 items)
       - Elements checks (10 items)
       - Relationships checks (7 items)
       - Total: 21 checklist items per diagram

    2. CALCULATE SCORES:
       For each diagram:
       - Pass rate: passed / (passed + failed)
       - Warning rate: warnings / total
       - Compliance level:
         - EXCELLENT: >= 90% pass, no fails
         - GOOD: >= 75% pass, <= 2 fails
         - NEEDS WORK: >= 50% pass
         - POOR: < 50% pass

       Overall score:
       - Average pass rate across all diagrams
       - Total fails across all diagrams
       - Overall compliance level

    3. IDENTIFY PATTERNS:
       - Common issues across diagrams
       - Systemic problems (same check failing in multiple diagrams)
       - Quick wins (easy fixes that improve multiple diagrams)

    4. PRIORITIZE FIXES:
       Priority based on:
       - Impact (affects understandability)
       - Effort (easy vs hard to fix)
       - Frequency (affects many diagrams)

       Categories:
       - CRITICAL: Diagram is confusing without this fix
       - HIGH: Significantly improves clarity
       - MEDIUM: Best practice improvement
       - LOW: Nice to have

    5. GENERATE RECOMMENDATIONS:
       For each failing check, provide:
       - What's wrong
       - Why it matters (from C4 perspective)
       - How to fix it (specific PlantUML syntax)

    OUTPUT FORMAT:
    ```json
    {
      "synthesis_summary": {
        "diagrams_verified": <count>,
        "total_checks_performed": <count>,
        "overall_pass_rate": "X%",
        "overall_compliance": "EXCELLENT|GOOD|NEEDS WORK|POOR"
      },
      "by_diagram": [
        {
          "file": "codemap/.../context.puml",
          "diagram_level": "context",
          "scores": {
            "general": "4/4",
            "elements": "8/10",
            "relationships": "6/7",
            "total": "18/21",
            "pass_rate": "86%",
            "compliance": "GOOD"
          },
          "issues": [
            {
              "category": "elements",
              "check": "element_purpose",
              "status": "warn",
              "details": "2 elements lack descriptions"
            }
          ]
        }
      ],
      "by_category": {
        "general": {
          "total_checks": <count>,
          "passed": <count>,
          "pass_rate": "X%",
          "common_issues": ["list"]
        },
        "elements": {
          "total_checks": <count>,
          "passed": <count>,
          "pass_rate": "X%",
          "common_issues": ["list"]
        },
        "relationships": {
          "total_checks": <count>,
          "passed": <count>,
          "pass_rate": "X%",
          "common_issues": ["list"]
        }
      },
      "patterns_identified": [
        {
          "pattern": "Missing technology labels",
          "affected_diagrams": ["container.puml", "component.puml"],
          "frequency": "60%",
          "impact": "HIGH"
        }
      ],
      "prioritized_fixes": [
        {
          "priority": "CRITICAL",
          "check": "relationship_labels",
          "affected_diagrams": ["codemap/.../container.puml"],
          "problem": "5 relationships have no labels",
          "why_it_matters": "Relationships are meaningless without labels describing intent",
          "how_to_fix": "Add descriptive label: Rel(a, b, \"Sends order data\", \"HTTP/REST\")"
        },
        {
          "priority": "HIGH",
          "check": "title",
          "affected_diagrams": ["codemap/.../component.puml"],
          "problem": "Diagram has no title",
          "why_it_matters": "Readers cannot identify diagram purpose at a glance",
          "how_to_fix": "Add: title \"Component Diagram: API Server\""
        }
      ],
      "quick_wins": [
        {
          "fix": "Add LAYOUT_WITH_LEGEND() to all diagrams",
          "effort": "LOW",
          "impact": "Adds legend to 5 diagrams"
        }
      ]
    }
    ```
```

---

## PHASE 3: Write Checklist Report

Generate a markdown report in `codemap/`.

### Step 3A: Write the Report

Create `codemap/<system-id>/C4-CHECKLIST.md`:

```markdown
# C4 Diagram Review Checklist Report

<!-- Generated: YYYY-MM-DD -->
<!-- Reference: https://c4model.com/diagrams/checklist -->

## Overall Compliance

| Metric | Value |
|--------|-------|
| Diagrams Verified | X |
| Total Checks | Y |
| Pass Rate | Z% |
| **Compliance Level** | **EXCELLENT/GOOD/NEEDS WORK/POOR** |

## Score by Diagram

| Diagram | Level | General | Elements | Relationships | Total | Compliance |
|---------|-------|---------|----------|---------------|-------|------------|
| context.puml | Context | 4/4 | 8/10 | 6/7 | 18/21 | GOOD |
| container.puml | Container | 3/4 | 9/10 | 5/7 | 17/21 | GOOD |
| ... | ... | ... | ... | ... | ... | ... |

## Score by Category

### General (4 checks per diagram)
- Pass Rate: X%
- Common Issues: [list]

### Elements (10 checks per diagram)
- Pass Rate: X%
- Common Issues: [list]

### Relationships (7 checks per diagram)
- Pass Rate: X%
- Common Issues: [list]

## Prioritized Fixes

### Critical

| Diagram | Issue | How to Fix |
|---------|-------|------------|
| container.puml | Relationships lack labels | Add: `Rel(a, b, "Descriptive label", "Protocol")` |

### High Priority

| Diagram | Issue | How to Fix |
|---------|-------|------------|
| ... | ... | ... |

### Medium Priority

| Diagram | Issue | How to Fix |
|---------|-------|------------|
| ... | ... | ... |

## Quick Wins

Easy fixes with high impact:

1. **Add legends to all diagrams**
   - Effort: Low (one line per file)
   - Impact: Improves 5 diagrams
   - Fix: Add `LAYOUT_WITH_LEGEND()` before `@enduml`

2. **[Next quick win]**
   - ...

## Detailed Results by Diagram

### context.puml

**Location:** `codemap/<system-id>/context.puml`
**Compliance:** GOOD (18/21)

#### General Checks
| Check | Status | Details |
|-------|--------|---------|
| Title | PASS | "System Context: Project Name" |
| Type Clarity | PASS | Uses C4_Context.puml |
| Scope Clarity | PASS | Clear system boundary |
| Legend | WARN | No legend, but uses standard notation |

#### Elements Checks
| Check | Status | Details |
|-------|--------|---------|
| Element Names | PASS | All 5 elements have names |
| Abstraction Level | PASS | Correct use of Person, System, System_Ext |
| ... | ... | ... |

#### Relationships Checks
| Check | Status | Details |
|-------|--------|---------|
| Labels | WARN | 2 relationships have generic labels |
| Direction Match | PASS | All labels match direction |
| ... | ... | ... |

---

[Repeat for each diagram]

---

## Checklist Reference

Based on https://c4model.com/diagrams/checklist:

### General
- [ ] Does the diagram have a title?
- [ ] Do you understand what the diagram type is?
- [ ] Do you understand what the diagram scope is?
- [ ] Does the diagram have a key/legend?

### Elements
- [ ] Does every element have a name?
- [ ] Do you understand the abstraction level of each element?
- [ ] Do you understand what every element does?
- [ ] Are technology choices associated with elements clear?
- [ ] Do you understand the meaning of all acronyms and abbreviations?
- [ ] Do you understand the meaning of all colours used?
- [ ] Do you understand the meaning of all shapes used?
- [ ] Do you understand the meaning of all icons used?
- [ ] Do you understand the meaning of all border styles used?
- [ ] Is the significance of element sizing apparent?

### Relationships
- [ ] Does every line have a label describing the intent?
- [ ] Does the description match the relationship direction?
- [ ] Are communication technologies and protocols identified?
- [ ] Do you understand the meaning of all acronyms and abbreviations?
- [ ] Do you understand the meaning of all colours used?
- [ ] Do you understand the meaning of all arrow heads used?
- [ ] Do you understand the meaning of all line styles used?
```

### Step 3B: Verify Report

```bash
# Confirm report was created
ls -la codemap/$SYSTEM_ID/C4-CHECKLIST.md

# Show report size
wc -l codemap/$SYSTEM_ID/C4-CHECKLIST.md
```

---

## Output Summary

```markdown
# C4 Checklist Verification Complete

## System: <system-id>

## Overall Results
- Diagrams Verified: X
- Total Checks: Y
- Pass Rate: Z%
- Compliance Level: EXCELLENT/GOOD/NEEDS WORK/POOR

## Summary by Category
| Category | Pass Rate | Common Issues |
|----------|-----------|---------------|
| General | X% | [issues] |
| Elements | Y% | [issues] |
| Relationships | Z% | [issues] |

## Top 3 Fixes Needed
1. [Critical fix description]
2. [High priority fix description]
3. [Medium priority fix description]

## Quick Wins Available
- [List of easy fixes]

## Report Location
`codemap/<system-id>/C4-CHECKLIST.md`

## Reference
https://c4model.com/diagrams/checklist
```

---

## Error Handling

**If no codemap exists:**
- Report that `/viz/c4-map` must be run first
- Exit without verification

**If no .puml files found:**
- Report that no diagrams exist to verify
- Suggest running `/viz/c4-map`

**If subagent verification fails:**
- Report which category failed
- Continue with other categories
- Note incomplete verification in report

**If all diagrams fail critical checks:**
- Generate report with all issues
- Recommend running `/viz/c4-map` with `--regenerate` flag
- Highlight systemic issues
